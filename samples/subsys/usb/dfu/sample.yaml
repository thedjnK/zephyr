sample:
  name: USB DFU sample

common:
  build_only: true
  arch_exclude: posix
  platform_exclude:
    - mimxrt1010_evk/mimxrt1011
    - mimxrt1050_evk@qspi/mimxrt1052
    - mimxrt1020_evk/mimxrt1021
    - mimxrt1015_evk/mimxrt1015
    - mimxrt1060_evk/mimxrt1062
    - sam4l_ek/sam4lc4c
    - mimxrt1050_evk/mimxrt1052
    - mimxrt1060_evk@hyperflash/mimxrt1062
    - nucleo_f207zg/stm32f207xx
    - teensy40/mimxrt1062
    - teensy41/mimxrt1062
    - b_u585i_iot02a/stm32u585xx
    - frdm_kl25z/mkl25z4
    - lpcxpresso55s69/lpc55s69/cpu0
    - stm32l562e_dk/stm32l562xx/ns
  depends_on: usb_device
  filter: dt_label_with_parent_compat_enabled("slot0_partition", "fixed-partitions")
    and dt_label_with_parent_compat_enabled("slot1_partition", "fixed-partitions")
    and dt_chosen_enabled("zephyr,flash-controller") and CONFIG_FLASH_HAS_DRIVER_ENABLED
  integration_platforms:
    - nrf52840dk/nrf52840
    - frdm_k64f/mk64f12
tests:
  sample.usb.dfu:
    tags: usb
  sample.usb.dfu.permanent.download:
    tags: usb
    extra_args: OVERLAY_CONFIG=overlay-permanent-download.conf
